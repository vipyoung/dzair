{% extends "template.html" %}
{% block qartatron %}
	<h1>Vote Map</h1>
	<p> Timely information about the spreading of boycott in Algeria.</p>
{% endblock %}

{% block body%}

<div id="map" style="height:600px;"></div>
<script src="{{ url_for('static', filename='data/communes_vote.js') }}"></script>
<script>

function getColor(d){
	return d == 1 ? '#F3EEEE' :
		d == 0 ? '#EB3838':
			'#000000';
	}

function style(feature) {
    return {
        fillColor: getColor(feature.properties.VOTE),
        weight: 1,
        opacity: 0.5,
        color: 'white',
        dashArray: '3',
        fillOpacity: 0.7
    };
}

	// Initialize the tile layers (base layers)
	var mapbox_sa_apikey = 'pk.eyJ1IjoidmlweW91bmciLCJhIjoiY2loZnp0OHVpMDRtcHRyajczeXVjMnJ6OSJ9.0fiqWEbVdr81UlgrRAquBw',
		mapboxUrl = 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}',
		mapboxAttribution = 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors,' +
		'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>,' +
		'Imagery © <a href="http://mapbox.com">Mapbox</a>',

		satellite = L.tileLayer(mapboxUrl, {
			id: 'mapbox.satellite',
			attribution: mapboxAttribution,
			accessToken: mapbox_sa_apikey
		}),
		streets = L.tileLayer(mapboxUrl, {
			id: 'mapbox.streets',
			attribution: mapboxAttribution,
			accessToken: mapbox_sa_apikey
		});
    // initialize the map

	var map = L.map('map', {
		center: [34.7024855, 3.432209],
		zoom: 7,
		layers: [streets]
	});

    // load a tile layer
   /* L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',
        maxZoom: 18,
        id: 'mapbox.streets',
        accessToken: mapbox_sa_apikey
    }).addTo(map);
	*/

	// load new segments GeoJSON
	/*var newSegStyle = {
    	"color": "red",
    	"weight": 1,
    	"opacity": 0.65
	};
	var Comm_Layer = L.geoJSON(null, {style: newSegStyle}).addTo(map);
	$.getJSON("{{url_for('static', filename='data/communes_vote.geojson')}}",
		function(data) {
			Comm_Layer.addData(data);
	});
	*/

	L.geoJson(commData, {style: style}).addTo(map);
	
	// load base map segments GeoJSON
	/* var existingSegStyle = {
    	"color": "black",
    	"weight": 2,
    	"opacity": 0.65
	};
	var ExistingSegs_Layer = L.geoJSON(null,{style:existingSegStyle}).addTo(map);
	$.getJSON("{{ url_for('static', filename='data/basemap.geojson') }}",
		function(data) {
			ExistingSegs_Layer.addData(data);
	});
	*/
	// Layer configuration/Management
	var baseMaps = {
		"Streets": streets,
		"Satellite": satellite
	};

	var overlayMaps = {
		// "BaseMap": ExistingSegs_Layer,
		"Communes": Comm_Layer
	};
	// var controller = L.control.layers(baseMaps, overlayMaps);
	var controller = L.control.layers(overlayMaps);
	controller.addTo(map);


</script>

{% endblock%}


